name: Sync to Serv00
on:
  push:
    branches:
      - main
    paths:
      - 'users.json'
      - 'config.json'

jobs:
  deploy:
    runs-on: ubuntu-latest
    steps:
      - name: ğŸšš Get latest code
        uses: actions/checkout@v3

      - name: ğŸ“¦ Create build directory
        run: |
          mkdir -p ./build
          # å¤åˆ¶éœ€è¦åŒæ­¥çš„æ–‡ä»¶åˆ° build ç›®å½•
          cp users.json config.json ./build/ 2>/dev/null || echo "Files not found, continuing..."

      - name: ğŸš€ Sync files to Serv00
        uses: SamKirkland/FTP-Deploy-Action@v4.3.4
        with:
          server: ${{ secrets.FTP_SERVER }}
          username: ${{ secrets.FTP_USERNAME }}
          password: ${{ secrets.FTP_PASSWORD }}
          server-dir: /public_html/404-vpn/
          local-dir: ./build/
          # æ ¹æ®æ‚¨çš„æœåŠ¡å™¨é…ç½®é€‰æ‹©æ­£ç¡®çš„åè®®
          # é€‰é¡¹1ï¼šSFTPï¼ˆé€šå¸¸ä½¿ç”¨ç«¯å£22ï¼‰
          protocol: sftp
          port: 22
          # æˆ–è€…é€‰é¡¹2ï¼šFTP/FTPS
          # protocol: ftps
          # port: 21
